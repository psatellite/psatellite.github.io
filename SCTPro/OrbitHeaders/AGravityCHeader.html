<html>
<head>
<title>AGravityC</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<?php
	$rootPath = "../..";
	include("$rootPath/includes/header.inc");
?>
</head>
<body>
<div class=page>

<h2>AGravityC:</h2>
<p>Path: Orbit/OrbitMechanics</p>
<pre>
% Compute the gravitational acceleration in cartesian coordinates. 
 Acceleration vectors are a [ aX;aY;aZ ].

 If the gravity coefficients are normalized, an additional matrix
 multiplication is required. The normalization matrix is stored as a persistent
 variable but AGravityC will gracefully update it if the normalization or order
 of the model changes between calls.
--------------------------------------------------------------------------
   Form:
   [aG, aS, aZ, aT] = AGravityC( r, nN, nM, d )  % structure
   [aG, aS, aZ, aT] = AGravityC( r, nN, nM, s, c, j, mu, a, useNormM )
--------------------------------------------------------------------------

   ------
   Inputs
   ------
   r           (3,:)    Position vector, planet-fixed
   nN          (1,1)    Highest zonal harmonic (m = 0)
                        (empty gives the max #) 
   nM          (1,1)    Highest sectorial and tesseral harmonic 
                        (empty gives the max #) 
   d            (.)     Gravity model struct
      -or-
   s           (:,:)    S terms
   c           (:,:)    C terms
   j             (:)    m = 0 terms
   mu          (1,1)    Spherical gravitational potential
   a           (1,1)    Planet radius
   useNormM    (1,1)    Generate the normalization matrix (default false)

   -------
   Outputs
   -------
   aG           (3,:)   Total gravitational acceleration km/sec^2
   aS           (3,:)   Spherical term                   km/sec^2
   aZ           (3,:)   Zonal term                       km/sec^2
   aT           (3,:)   Tesseral term                    km/sec^2

--------------------------------------------------------------------------
	 Reference: Bond, V. R. and M. C. Allman (1996.) Modern Astrodynamics.
                Princeton. pp. 212-213.
             Lerch, F. J., Klosko, S. M., Labuscher, R. E., Wagner,
                C.A., "Gravity Model Improvement GEOS-3 (GEM 9 & 10)," 
                N78-10645, September, 1977.
             Gottlieb, R. G., "Fast Gravity, Gravity Partials, Normalized 
                Gravity, Gravity Graident Torque and Magnetic Field: 
                Derivation, Code and Data, NASA CR 188243, February, 1993.
--------------------------------------------------------------------------
   See also UnnormalizeGravity, AGravity (output in spherical coords)
--------------------------------------------------------------------------
</pre>

<h2>Children:</h2>
<pre>
<a href="../OrbitHeaders/LoadGEMHeader.html">Orbit: GravityModels/LoadGEM</a>
<a href="../OrbitHeaders/NormalizationMatrixHeader.html">Orbit: GravityModels/NormalizationMatrix</a>
<a href="../CommonHeaders/Plot2DHeader.html">Common: Graphics/Plot2D</a>
</pre>
<hr><p> <a href="../OrbitFunctions.html">Back</a> to the Orbit Module page</p></div>
<?php include("$rootPath/includes/footer.inc"); ?>
</html>
