<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ControlDeck: Control Systems Architecture</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="navpath">
    <ul>
      <li><a class="el" href="index.html">ControlDeck 2.0</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>Control Systems Architecture </h1>  </div>
</div>
<div class="contents">
<p>ControlDeck is designed for real-time control systems and utilizes the concepts of timers and events. It's very important to note that ControlDeck does not run code unless some module is responding to an event or a timer. Therefore, it is generally necessary that at least one module have installed a timer; otherwise no code will ever run. The exception to this is when modules utilize the background processing functions.</p>
<h2><a class="anchor" id="timers"></a>
Timers</h2>
<p>Individual modules can request that ControlDeck notify them after a certain time period has passed. This allows them to go to sleep, waking up only on a pre-defined schedule to perform work. For instance, a module might request to be notified every half-second to perform some particular control work. Timers can be set on a per-module basis, and the only limitation is based on the hardware's timer granularity. This is typically at the millisecond level. It is quite possible for module A to request a timer every 300 milliseconds, and module B to request a separate timer at a 5 second interval. An individual module can even have multiple timers active at once, if different jobs require different sequencing; the module will be woken up separately for each job, and a unique code is provided so that the module knows what timer has been fired. For more information on timers, see <a class="el" href="classcd__control__module.html#ab12bc368c82c9ab95e0a4623db3fcbaa" title="Request that a timer be called at a specific interval for periodic tasks.">cd_control_module::request_timer()</a></p>
<h2><a class="anchor" id="events"></a>
Events</h2>
<p>Modules can also request to be notified when events are triggered. An event is uniquely identified by a group and name, just as with a variable; also like a variable, the group defaults to the name of the module's system. A particular module triggers the event by specifying the group and name of the event to trigger; all other modules that have requested notification for that event are then woken up to respond to it. It is important to note that the module triggering the event will block (not continue working) until all other interested modules have responded to the event. It is also important to note that if multiple modules have requested notification of a single event, the order in which they will respond to that event is nondeterministic and cannot be relied upon. If modules must act in a specific order, there are two options:</p>
<ul>
<li>each module triggers a new event to wake up the module that is next in line for processing,</li>
<li>the initial triggering module triggers a set of events in sequence, with only a single module waiting on each individual event.</li>
</ul>
<p>Either option is acceptable, but the second is generally easier to maintain and can be slightly more performant.</p>
<p>ControlDeck provides only one built-in event: the simulation update event (accessible using the group name CD_SYSTEM_GROUP and event name CD_SIMULATION_STEP_EVENT; no quotes as these are macros). This event is triggered after each timestep when ControlDeck is running a DSim simulation for providing data. If the control system will be migrating to working with real hardware, consider using a timer instead, so that no changes will need to be made later on. Note especially that this event will never be sent if no simulation is associated with the control deck.</p>
<h2><a class="anchor" id="background"></a>
Background processing</h2>
<p>Modules will only run when a timer or event triggers them, unless they have initiated a background process. Background threads may be running even if no main module threads are actively responding to timers or events, and main modules may be woken up when a background thread completes. See start_background_task(), run_background_task(), handle_intermediate_data(), and complete_background_task(). </p>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Fri Apr 5 2013 17:06:31 for ControlDeck by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.2 </small></address>
</body>
</html>
