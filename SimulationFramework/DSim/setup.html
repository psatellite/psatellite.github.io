<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>DSim: Setup Files</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.2 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div class="navpath">
    <ul>
      <li><a class="el" href="index.html">index</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>Setup Files </h1>  </div>
</div>
<div class="contents">
<h2><a class="anchor" id="setup_overview"></a>
Overview</h2>
<p>Simulations are initialized via text-based setup files. A simulation can include models from multiple model libraries, each with a specified integrator. Parameters and states can be initialized to specific values in the setup file.</p>
<p>The DSimManager application supports the creation and modification of setup files, which are xml. The application includes a test facility to ensure the simulation you have created will run.</p>
<p>This page describes the directives used in the xml files.</p>
<h2><a class="anchor" id="setup_directives"></a>
Directives</h2>
<p>The required fields are:</p>
<ul>
<li><b>startJD</b> The simulation epoch in Julian date.</li>
<li><b>timeStep</b> The simulation time step in seconds.</li>
<li><b>startSeconds</b> The simulation start time step in seconds.</li>
</ul>
<p>Additional possible directives are:</p>
<ul>
<li><b>name</b> The name of the simulation.</li>
<li><b>maxTimeStep</b> The maximum time step allowed. This cannot be less than the nominal timeStep.</li>
<li><b>endSeconds</b> The simulation end time in seconds. This must be greater than startSeconds.</li>
<li><b>timeScale</b> The simulation time scale ratio, sim time/real time. A time scale of -1 will tell the simulation to run as fast as possible.</li>
<li><b>outputLogFile</b> The path to the message log file.</li>
<li><b>dataLogFile</b> The path to the data log file.</li>
</ul>
<h2><a class="anchor" id="object_setup"></a>
Objects</h2>
<p>The object tree is the heart of the DSim setup file. A simulation requires at least one object in the tree. Each object can have children. The directives required for each object are:</p>
<ul>
<li><b>name</b> The human-readable name of the object.</li>
<li><b>type</b> The model class of the object.</li>
<li><b>library</b> The path to the model library containing the class.</li>
<li><b>integrator</b> The name of the integrator to use.</li>
</ul>
<p>The additional possible fields are:</p>
<ul>
<li><b>telemetry</b> Mark the named variable as a telemetry point.</li>
<li><b>command</b> Mark the named variable as a command.</li>
<li><b>logVariable</b> Log the named variable to the data log file.</li>
<li><b>child</b> Children objects</li>
<li><b>setValue</b> Set a variable value, with the subfields <b>variable</b> and <b>value</b></li>
<li><b>dependency</b> An object on which this object is dependent</li>
<li><b>connectOutlet</b> Connect one model's variable to another model's outlet, with the subfields <b>variable</b> and <b>source</b>.</li>
<li><b>connectTarget</b> Connect a target, with the subfields <b>name</b> and <b>target</b>.</li>
</ul>
<h3><a class="anchor" id="objsetup"></a>
Setup directives</h3>
<p>A model may accept custom setup commands. For instance, files may need to be loaded for a particular model. This is handled with subfields <b>key</b> and <b>value</b>. The model is responsible for appropriately handing the setup keys in the dsim_model::parse_setup() function. An example loading a JPL ephemeris file is shown below.</p>
<div class="fragment"><pre class="fragment">
    &lt;setup&gt;
        &lt;key&gt;AddSPKFile&lt;/key&gt;
        &lt;value&gt;/Library/Application Support/VisualCommander/Model Libraries/de414.bsp&lt;/value&gt;
    &lt;/setup&gt;
    </pre></div><p>See the <a class="el" href="group__model__initialization.html">Model Initialization</a> module.</p>
<h3><a class="anchor" id="attributes"></a>
Attributes</h3>
<p>Attributes can be set up programmatically in a model, or ad hoc in a setup file. See the <a class="el" href="group__model__attributes.html">Model Attributes</a> module. In the setup file, the <b>attribute</b> directive can be used with <b>name</b> and <b>value</b> fields.</p>
<h2><a class="anchor" id="integrator_setup"></a>
Integrators</h2>
<p>The integrators used in the simulation are introduced in the header of the simulation and then referenced as needed by each object. For instance, you might have RK4 and RK78 both listed and then used for different objects. Integrators must be specified by library and type (class) and may also have custom setup directives.</p>
<ul>
<li><b>name</b> The human-readable name of the object.</li>
<li><b>type</b> The model class of the object.</li>
<li><b>library</b> The path to the model library containing the class.</li>
<li><b>setup</b> key/value pairs for custom setup directives. For instance, setting a tolerance or minimum timestep for a variable step integrator.</li>
</ul>
<h2><a class="anchor" id="Example"></a>
Setup File</h2>
<p>The example file shown below contains a single integrator and a single second-order object. The setup file must specify at least one integrator and at least one object in the object tree to have a functional simulation.</p>
<div class="fragment"><pre class="fragment">
     &lt;Simulation&gt;
        &lt;version&gt;1&lt;/version&gt;
        &lt;timeStep&gt;0.01&lt;/timeStep&gt;
        &lt;startSeconds&gt;0&lt;/startSeconds&gt;
        &lt;startJD&gt;2455623.953075618&lt;/startJD&gt;
        &lt;timeScale&gt;1&lt;/timeScale&gt;
        &lt;name&gt;Second Order Dynamic Simulation&lt;/name&gt;
        &lt;integrator&gt;
            &lt;name&gt;RK4&lt;/name&gt;
            &lt;type&gt;DSimRK4&lt;/type&gt;
            &lt;library&gt;builtin&lt;/library&gt;
        &lt;/integrator&gt;
        &lt;objectTree&gt;
            &lt;object&gt;
                &lt;name&gt;second_order&lt;/name&gt;
                &lt;type&gt;DSimSecondOrder&lt;/type&gt;
                &lt;library&gt;builtin&lt;/library&gt;
                &lt;integrator&gt;RK4&lt;/integrator&gt;
                &lt;logVariable&gt;yDotDot&lt;/logVariable&gt;
                &lt;logVariable&gt;yDot&lt;/logVariable&gt;
                &lt;logVariable&gt;y&lt;/logVariable&gt;
            &lt;/object&gt;
        &lt;/objectTree&gt;
    &lt;/Simulation&gt;
    </pre></div><p>A variable is set using the following lines:</p>
<div class="fragment"><pre class="fragment">
    &lt;setValue&gt;
        &lt;variable&gt;my_state&lt;/variable&gt;
        &lt;value&gt;0.1&lt;/value&gt;
    &lt;/setValue&gt;
    </pre></div><p>An outlet is connected using the follow lines:</p>
<div class="fragment"><pre class="fragment">
    &lt;connectOutlet&gt;
        &lt;variable&gt;myVar&lt;/variable&gt;
        &lt;source&gt;Parent1|Child1:param1&lt;/source&gt;
    &lt;/connectOutlet&gt;
    </pre></div><p>An additional example using some of the builtin models with logging is shown below. This example also includes a child object and setting of some variable initial values. Observe that the dependency setting uses the following path to the child spring object: PointMass|Spring.</p>
<div class="fragment"><pre class="fragment">
&lt;Simulation&gt;
    &lt;version&gt;1&lt;/version&gt;
    &lt;comments&gt;This is a test simulation, only really good <span class="keywordflow">for</span> verifying that DSim is properly doing integration and that DSim Manager can properly read and write files.&lt;/comments&gt;
    &lt;timeStep&gt;0.1&lt;/timeStep&gt;
    &lt;maxTimeStep&gt;0.1&lt;/maxTimeStep&gt;
    &lt;startSeconds&gt;0&lt;/startSeconds&gt;
    &lt;endSeconds&gt;10&lt;/endSeconds&gt;
    &lt;startJD&gt;2451816.51111&lt;/startJD&gt;
    &lt;timeScale&gt;1&lt;/timeScale&gt;
    &lt;dataLogfile&gt;SpringData.log&lt;/dataLogfile&gt;
    &lt;name&gt;Example Simulation&lt;/name&gt;
    &lt;integrator&gt;
        &lt;name&gt;primary&lt;/name&gt;
        &lt;type&gt;DSimRK4&lt;/type&gt;
        &lt;library&gt;builtin&lt;/library&gt;
    &lt;/integrator&gt;
    &lt;objectTree&gt;
        &lt;<span class="keywordtype">object</span>&gt;
            &lt;name&gt;PointMass&lt;/name&gt;
            &lt;type&gt;DSimRigidBody&lt;/type&gt;
            &lt;library&gt;builtin&lt;/library&gt;
            &lt;integrator&gt;primary&lt;/integrator&gt;
            &lt;setValue&gt;
                &lt;variable&gt;position&lt;/variable&gt;
                &lt;value&gt;[0; 1; 0]&lt;/value&gt;
            &lt;/setValue&gt;
            &lt;setValue&gt;
                &lt;variable&gt;velocity&lt;/variable&gt;
                &lt;value&gt;[0; 2; 0]&lt;/value&gt;
            &lt;/setValue&gt;
            &lt;dependency&gt;PointMass|Spring&lt;/dependency&gt;
            &lt;logVariable&gt;position&lt;/logVariable&gt;
            &lt;logVariable&gt;velocity&lt;/logVariable&gt;
            &lt;telemetry&gt;mass&lt;/telemetry&gt;
            &lt;telemetry&gt;position&lt;/telemetry&gt;
            &lt;telemetry&gt;velocity&lt;/telemetry&gt;
            &lt;command&gt;mass&lt;/command&gt;
            &lt;child&gt;
                &lt;name&gt;Spring&lt;/name&gt;
                &lt;type&gt;DSimIdealSpring&lt;/type&gt;
                &lt;library&gt;builtin&lt;/library&gt;
                &lt;integrator&gt;primary&lt;/integrator&gt;
                &lt;connectTarget&gt;
                    &lt;name&gt;mass&lt;/name&gt;
                    &lt;target&gt;PointMass&lt;/target&gt;
                &lt;/connectTarget&gt;
                &lt;telemetry&gt;x0&lt;/telemetry&gt;
                &lt;telemetry&gt;k&lt;/telemetry&gt;
                &lt;command&gt;k&lt;/command&gt;
            &lt;/child&gt;
        &lt;/<span class="keywordtype">object</span>&gt;
    &lt;/objectTree&gt;
&lt;/Simulation&gt;
</pre></div><p>Since the setup files are actually text files, they are easy to configuration manage. They can also be compared against each other in a file merge utility. </p>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Fri Apr 5 2013 16:46:48 for DSim by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.2 </small></address>
</body>
</html>
