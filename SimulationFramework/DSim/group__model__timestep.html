<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>DSim: Model Timestep and Integration</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.2 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>Model Timestep and Integration</h1>  </div>
</div>
<div class="contents">

<p><a class="el" href="classdsim__model.html" title="Superclass for all simulated objects.">dsim_model</a> member functions that handle timestep updates.  
<a href="#_details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__model__timestep.html#ga25ac9a5a1ee3260a30aaef9fb97b9c77">dsim_model::initialize_timestep</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Overridden by subclasses to prepare for the timestep.  <a href="#ga25ac9a5a1ee3260a30aaef9fb97b9c77"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__model__timestep.html#ga88a19c9ba893bd18df4e708d08150766">dsim_model::pre_calculate</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Overridden by subclasses to do any single-time calculations necessary before integration.  <a href="#ga88a19c9ba893bd18df4e708d08150766"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__model__timestep.html#ga0e324402155e9956f4c8c02d35dbf92d">dsim_model::post_calculate</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Overridden by subclasses to do any single-time calculations necessary after integration.  <a href="#ga0e324402155e9956f4c8c02d35dbf92d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__model__timestep.html#ga2d7aeaae9f9e6c112761750b3fd4034c">dsim_model::complete_timestep</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Overridden by subclasses to do any necessary post-timestep cleanup.  <a href="#ga2d7aeaae9f9e6c112761750b3fd4034c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__model__timestep.html#gae3ae731f0b9a09090b6997433e3db1c0">dsim_model::rhs</a> (double t, double jd)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Overridden by subclasses to set the derivatives of integrated states.  <a href="#gae3ae731f0b9a09090b6997433e3db1c0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__model__timestep.html#ga81b8ac705d7398234ed646e1230a7b3b">dsim_model::configure_timestep</a> (bool call_pre, bool call_rhs, bool call_post)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Called to set which functions are called during a timestep.  <a href="#ga81b8ac705d7398234ed646e1230a7b3b"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p><a class="el" href="classdsim__model.html" title="Superclass for all simulated objects.">dsim_model</a> member functions that handle timestep updates. </p>
<p>These methods handle the updating of the object at each timestep. Timesteps are managed by the simulation in a strict order. Within each step, the order in which the associated function is called on each object is determined by the dependencies between objects that are provided in the simulation setup file. The order of calls is: </p>
<ol>
<li>
initialize_timestep() </li>
<li>
pre_calculate() is called if it has been enabled via configure_timestep() </li>
<li>
rhs() is called as many times as the object's integrator demands. rhs() is only called on an object if the object has integrated states or has enabled it via configure_timestep() </li>
<li>
post_calculate() is called if it has been enabled via configure_timestep() </li>
<li>
complete_timestep() </li>
</ol>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ga2d7aeaae9f9e6c112761750b3fd4034c"></a><!-- doxytag: member="dsim_model::complete_timestep" ref="ga2d7aeaae9f9e6c112761750b3fd4034c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dsim_model::complete_timestep </td>
          <td>(</td>
          <td class="paramname">&#160;)</td>
          <td><code> [virtual, inherited]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Overridden by subclasses to do any necessary post-timestep cleanup. </p>
<p>Called on all objects, in an order determined by dependencies specified in the simulation setup file, at the end of each timestep. Models that override this function must take care to call their superclass's implementation as well. </p>

<p>Reimplemented in <a class="el" href="classdsim__rigid__body.html#a900b84b813d383b679dbbadf459c76b5">dsim_rigid_body</a>, and <a class="el" href="classdsim__second__order.html#aa2c144e850dec7b52e9d9e740e6cea90">dsim_second_order</a>.</p>

</div>
</div>
<a class="anchor" id="ga81b8ac705d7398234ed646e1230a7b3b"></a><!-- doxytag: member="dsim_model::configure_timestep" ref="ga81b8ac705d7398234ed646e1230a7b3b" args="(bool call_pre, bool call_rhs, bool call_post)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dsim_model::configure_timestep </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"> <em>call_pre</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"> <em>call_rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"> <em>call_post</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, inherited]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Called to set which functions are called during a timestep. </p>
<p>Specify which timestep functions should be called on the object. By default, neither pre_calculate() nor post_calculate() will be called on the object, and rhs() will be called only if the object has at least one integrated state variable. Models can call configure_timestep() to turn on or off calls to these three functions. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">call_pre</td><td>Whether or not pre_calculate() should be called on this object. </td></tr>
    <tr><td class="paramname">call_rhs</td><td>Whether or not rhs() should be called on this object. </td></tr>
    <tr><td class="paramname">call_post</td><td>Whether or not post_calculate() should be called on this object. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga25ac9a5a1ee3260a30aaef9fb97b9c77"></a><!-- doxytag: member="dsim_model::initialize_timestep" ref="ga25ac9a5a1ee3260a30aaef9fb97b9c77" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dsim_model::initialize_timestep </td>
          <td>(</td>
          <td class="paramname">&#160;)</td>
          <td><code> [virtual, inherited]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Overridden by subclasses to prepare for the timestep. </p>
<p>Called on all objects, in an order determined by dependencies specified in the simulation setup file, at the beginning of each timestep. Models that override this function must take care to call their superclass's implementation as well. </p>

<p>Reimplemented in <a class="el" href="classdsim__rigid__body.html#a07c00a07f57b3ed7ec945aef2601e534">dsim_rigid_body</a>, and <a class="el" href="classdsim__second__order.html#a18482d41859a953ff81e362b8ab02d7e">dsim_second_order</a>.</p>

</div>
</div>
<a class="anchor" id="ga0e324402155e9956f4c8c02d35dbf92d"></a><!-- doxytag: member="dsim_model::post_calculate" ref="ga0e324402155e9956f4c8c02d35dbf92d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dsim_model::post_calculate </td>
          <td>(</td>
          <td class="paramname">&#160;)</td>
          <td><code> [virtual, inherited]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Overridden by subclasses to do any single-time calculations necessary after integration. </p>
<p>Optionally called on objects, in order determined by dependencies specified in the simulation file, after the intra-timestep integration loop ends. Models may opt-in to having post_calculate() called on them by passing true as the third parameter to a call to configure_timestep(), usually in their initialize_data() or initialization_complete() methods. Models that override this function must take care to call their superclass's implementation as well. </p>

</div>
</div>
<a class="anchor" id="ga88a19c9ba893bd18df4e708d08150766"></a><!-- doxytag: member="dsim_model::pre_calculate" ref="ga88a19c9ba893bd18df4e708d08150766" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dsim_model::pre_calculate </td>
          <td>(</td>
          <td class="paramname">&#160;)</td>
          <td><code> [virtual, inherited]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Overridden by subclasses to do any single-time calculations necessary before integration. </p>
<p>Optionally called on objects, in order determined by dependencies specified in the simulation file, prior to the intra-timestep integration loop beginning. Models may opt-in to having pre_calculate() called on them by passing true as the first parameter to a call to configure_timestep(), usually in their initialize_data() or initialization_complete() methods. Models that override this function must take care to call their superclass's implementation as well. </p>

</div>
</div>
<a class="anchor" id="gae3ae731f0b9a09090b6997433e3db1c0"></a><!-- doxytag: member="dsim_model::rhs" ref="gae3ae731f0b9a09090b6997433e3db1c0" args="(double t, double jd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dsim_model::rhs </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"> <em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"> <em>jd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [virtual, inherited]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Overridden by subclasses to set the derivatives of integrated states. </p>
<p>The rhs() function is where all integration occurs. Model implementations of rhs() should calculate and store the derivatives for any integrated states by calling <a class="el" href="classdsim__variable.html#a5254ad1019659c596863c7b5a02f2efe" title="Sets the current derivative of this variable by providing a data type and a raw value pointer...">dsim_variable::set_derivative()</a> on the appropriate variables. Models may also implement rhs() to perform co-integration message passing- for instance, sending messages to apply forces and torques that other objects need to integrate.</p>
<p>Objects have rhs() called on them in an order determined by dependencies specified in the simulation, and will generally have it called on them multiple times per timestep. How many times is determined by the object's assigned integrator.</p>
<p>All objects that have integrated states will have rhs() called on them. In addition, models may opt-in to having rhs() called on them by passing true as the second parameter to a call to configure_timestep().</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">t</td><td>The simulation time that should be used for any time-dependent calculations for derivatives. </td></tr>
    <tr><td class="paramname">jd</td><td>The Julian Date matching the simulation time. </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="classdsim__ideal__gravity.html#a34071bbdfa58fba33e8af841ea51df21">dsim_ideal_gravity</a>, <a class="el" href="classdsim__ideal__spring.html#a11c8a315f202c3c3d7ece54d5e2a3300">dsim_ideal_spring</a>, <a class="el" href="classdsim__rigid__body.html#a04ef4a6c0efbdf2e9c0f33806a02da01">dsim_rigid_body</a>, and <a class="el" href="classdsim__second__order.html#a2d5a8290a1a991361d124d850c5295bc">dsim_second_order</a>.</p>

</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Fri Apr 5 2013 16:46:48 for DSim by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.2 </small></address>
</body>
</html>
